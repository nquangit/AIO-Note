Exported from Evernote.
Noted at 31/08/2021

[https://picoctf.org](https://picoctf.org)

# nquangit

Ở đây chúng ta chỉ chú trọng phần Web Exploitation

Chúng ta sẽ bắt đầu với picoCTF 2019

- ### Insp3ct0r
    

- ![](https://public.www.evernote.com/resources/s517/19b05475-9bf7-2d56-ff9f-637eab877495)
- Ta sẽ có một giao diện web như trên, nhiệm vụ của chúng ta là phải tìm ra cờ để nộp.
    
    Tiến hành xem nguồn trang (Ctrl + U)
    
- ![](https://public.www.evernote.com/resources/s517/f2b44248-d421-e152-e736-c5363db8b704)
- Và chúng ta có 1/3 cờ
    
    Tiếp tục xem file css và javascript
    
- ![](https://public.www.evernote.com/resources/s517/6ade4881-c7f8-9f3f-a60c-d858075e65a1)
- Và chúng ta sẽ tìm được cờ đầy đủ
    
- ### Complete
    

  

- ### where are the robots
    

- ![](https://public.www.evernote.com/resources/s517/1a2725c7-d404-cc28-9a2c-d042827bc51a)
- Ta có một giao diện web
    
    Và muốn biết robots là cái gì thì hỏi google là có
    
    Và file đó sẽ là robots.txt và nằm trong thư mục gốc của trang web đó
    
- ![](https://public.www.evernote.com/resources/s517/3a7fbe21-ecec-8f3f-f478-1c3a4a4fe3fd)
- Và ta có được là, và thử truy cập vào file html trên
    
- ![](https://public.www.evernote.com/resources/s517/73b7e38b-0088-3391-3630-d4737f170adc)
- Và chúng ta đã hoàn thành
    

- ### Logon
    

- ![](https://public.www.evernote.com/resources/s517/dd6252f9-70ab-c61a-e91c-7b5ebc38e40c)
- Chúng ta có một form đăng nhập, và nhập thông tin như thế nào cũng sẽ truy cập được
    
    Nhưng
    
- ![](https://public.www.evernote.com/resources/s517/65d87fb5-b846-28ee-4200-9c1a517bc4e6)
- Chả có cái gì để lấy cả :(((
    
    Thử xem Cookies của trang xem sao (Ấn F12)
    
- ![](https://public.www.evernote.com/resources/s517/0fb69fda-a9b9-3f1e-8007-2038cfc76a63)
- Ta thấy có một Cookies admin = False và chỉ cần sửa lại giá trị là True và Refresh lại trang là chúng ta đã có thể lấy được cờ :))
    

  

- ### dont-use-client-side
    

- ![](https://public.www.evernote.com/resources/s517/230885bf-c65a-8ecd-f73a-e897ac239001)
- Một form nhập mật khẩu
    
    Vẫn phải xem nguồn trang như thế nào đã
    
- ![](https://public.www.evernote.com/resources/s517/fe32c298-33b7-5864-14f7-f48a1d77308b)
- Có cả một mớ javascript hỗn độn như thế này
    
    Ta có thể sắp xếp bằng tay lại
    
    Hoặc có thể tự viết một đoạn script để tự sắp xếp lại cho chúng ta
    
- Đến đây coi như đã hoàn thành :)))
    

- ### PicoBrowser
    

- ![](https://public.www.evernote.com/resources/s517/463c04df-64dc-3776-b81d-e9c084cebea9)
- Khi nhấn nút lấy flag thì nó bảo chúng ta không phải đang dùng picobrowser
    
    Thật ra cũng chả có cái picobrowser nào cả nên không cần phải tốn công lên mạng tìm tải rồi mở bằng trình duyệt đó , kkk
    
- Chỉ cần chúng ta chỉnh sửa "User Agent" của chúng ta là được
    
    Có rất nhiều cách để sửa nhưng mà Edge có hỗ trợ nên dùng luôn cho tiện
    
    Nếu không thì có thể tìm các extension Change User Agent
    
- ![](https://public.www.evernote.com/resources/s517/a895bd38-1aa3-4d29-07bb-683e13448f97)
- Nếu không thấy tag Network conditions thì ấn vào dấu cộng rồi tìm
    
    Sau đó bỏ tick Use browser Default
    
    Chọn custom và điền vào là picobrowser và load lại trang web là ta đã có thể lấy được cờ
    

- ### Client-side-again
    

- ![](https://public.www.evernote.com/resources/s517/510ee2fa-3284-f1fb-b051-981036fbe08b)
- Vẫn lại lạ form nhập pass, lại xem nguồn trang
    
- ![](https://public.www.evernote.com/resources/s517/c20a653b-fd38-d9be-6dc0-469fd2984f39)
- Thấy một mớ này, và có cái biến gì đó, thử xem xem nó có gì
    
- ![](https://public.www.evernote.com/resources/s517/91ac97ec-0812-dbf0-6159-c6ad7caaff2d)
- Ghép lại là ta đã có cờ
    

- ### Irish-Name-Repo 1
    

- ![](https://public.www.evernote.com/resources/s517/20e81b2a-1d60-625e-b1ba-e5673f64a08f)
- Cái thứ quái gì cũng chả hiểu nữa, có cái dấu 3 gạch menu ấy, vào xem thì có Admin Login
    
    Vọc xem làm gì được không
    
- Thử một hồi thì thấy trang này có bị SQLi (SQL Injection)
    
    Nhập username là : ' or 1=1;--
    
    Mật khẩu thì không cần vì ta đã ghi chú phần sau rồi (với --)
    
- Và ta thành công lấy cờ :)))
    

- ### Irish-Name-Repo 2
    

- Vẫn như cũ nhưng ở một level cao hơn
    
- ![](https://public.www.evernote.com/resources/s517/a57db8cd-d10f-845f-3d30-a38b922aa820)
- Nhập như lúc nãy thì sẽ không được
    
- Chỉ cần nhập Username: admin'--
    
    Password đã được lọc, nên không thêm vào sẽ không thành công
    

- ### Irish-Name-Repo 3
    

- Level cao hơn nữa
    
- Họ gợi ý cho chúng ta là password đã được mã hóa, nhưng mình nhập nó không hiện lỗi nên khó mà biết nó được mã hóa như thế nào
    
- ![](https://public.www.evernote.com/resources/s517/94d53824-970c-76ce-6176-7604fb312e1a)
- Bật chế độ debug và từ đó ta có thể xem câu truy vấn trả về
    
    Như ta thấy test sẽ được mã hóa thành grfg
    
    Chữ t sẽ được mã hóa thành g, đây là mã hóa Casear cipher
    
- Giờ ta muốn nhập password: ' or 1=1-- để khai thác lỗi SQLi thì phải nhập là: ' be 1=1--
    
- Và chúng ta thành công lấy được cờ